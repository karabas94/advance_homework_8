{% extends 'base.html' %}

{% block title %}{{ object.title }}{% endblock %}

{% block content %}

    <ul>
        <li>
            <h2>{{ object.title }}</h2>
            <p>{{ object.text }}</p>
            {% if object.image and object.image.url %}
                <img src="{{ object.image.url }}">
            {% endif %}
            <p><a href="{% url 'user_profile' post.author.pk %}">{{ object.author }}</a></p>
            <p>{{ object.created_at }}</p>

            {% if object.author == request.user %}
                <p><a href="{% url 'blog:post_update' object.pk %}">Edit</a></p>
                <p><a href="{% url 'blog:post_delete' object.pk %}">Delete</a></p>
            {% endif %}

        </li>
    </ul>

    <h3>Comments</h3>
    {% if comments %}
        <ul>
            {% for comment in comments %}
                <li>
                    <p>{{ comment.name }}</p>
                    <p>{{ comment.message }}</p>
                    <p>{{ comment.created_at }}</p>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No comments yet.</p>
    {% endif %}


    <h3>Add a Comment</h3>
    <form method="post" action="{% url 'blog:add_comment' object.pk %}">
        {% csrf_token %}
        {% if user.is_authenticated %}
            <input type="hidden" name="name" id="name" value="{{ user.username }}" readonly>
        {% else %}
            <label for="name" >Name:</label>
            <input type="text" name="name" id="name" required>
        {% endif %}
        <br>
        <label for="message">Message:</label>
        <textarea name="message" id="message" required></textarea>
        <br>
        <button type="submit">Submit</button>
    </form>
{% endblock %}